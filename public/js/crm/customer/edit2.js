$(function(){Industry.load('#companyId','#industrySelect','');$('#addMobile').click(function(){var input='<input type="text" class="form-control inputer"/>';$('.mobileInputArea').append(input);});$('#addEmail').click(function(){var input='<input type="text" class="form-control inputer"/>';$('.emailInputArea').append(input);});$('#addFax').click(function(){var input='<input type="text" class="form-control inputer"/>';$('.faxInputArea').append(input);});$('#addWebsite').click(function(){var input='<input type="text" class="form-control inputer"/>';$('.websiteInputArea').append(input);});$('#addBankAccount').click(function(){var input=$('.bankInputer .inputer').clone();$('.bankAccountArea').append(input);});$('#btnSave').click(function(){if(checkform()){$('#btnSave').prop('disabled',true);$('#loadingModal').modal('show');var mobiles=[];$('.mobileInputArea .inputer').each(function(){if($(this).val()){mobiles.push($(this).val());}});if(mobiles.length){$('#mobiles').val(JSON.stringify(mobiles));}else{$('#mobiles').val('');}
var emails=[];$('.emailInputArea .inputer').each(function(){if($(this).val()){emails.push($(this).val());}});if(emails.length){$('#emails').val(JSON.stringify(emails));}else{$('#emails').val('');}
var faxs=[];$('.faxInputArea .inputer').each(function(){if($(this).val()){faxs.push($(this).val());}});if(faxs.length){$('#faxs').val(JSON.stringify(faxs));}else{$('#faxs').val('');}
var websites=[];$('.websiteInputArea .inputer').each(function(){if($(this).val()){websites.push($(this).val());}});if(websites.length){$('#websites').val(JSON.stringify(websites));}else{$('#websites').val('');}
var industriesArr=[];$('#industry-items .industry-item').each(function(){industriesArr.push($(this).attr('data-id'))})
$('#industries').val(JSON.stringify(industriesArr));$('#crmAccount').submit();}});$('#industrySelect').on('change',function(){if(!$(this).val()){return;}
var id=$(this).val();var name=$(this).find('option[value="'+id+'"]').text();addIndustry(id,name);});$('#industry-items').on('click','.removeItem',function(){$(this).closest('span').remove();});$('.delete-industry').on('click',function(){var industryId=$(this).closest('span').attr('data-id');var item=$(this);$.post('/company/industry/remove',{'industryId':industryId,'accountId':accountId,},function(rs){if(rs.code){item.closest('span').remove();}});})
$('.del_information').on('click',function(){var item=$(this);$.post('/crm/lead/deleteinformation',{'id':$(this).attr('data-id'),},function(rs){if(rs.code){item.closest('span').remove();}});})});function checkform(){var isValid=true
$('#crmAccount .error').removeClass('error');$('#crmAccount .control-label span.required').each(function(){var item=$(this).closest('.form-group').find('select, input[type="text"]');if(!item.val()){item.addClass('error');item.focus();isValid=false;}});return isValid;}
function addInformation(displayData,contentData){var temp=$('#infomationTempale .information').clone();temp.find('.information-content').html(displayData);text.find('.submitData').val(contentData);return temp;}
function addIndustry(id,name){if(!id||!name){return;}
if($('#industry-items .industry-item[data-id="'+id+'"]').length){return false;}
var html='<span data-id="'+id+'" class="label label-default industry-item"> '+name+' <i class="fa fa-times removeItem text-danger"></i></span>';$('#industry-items').append(html);}