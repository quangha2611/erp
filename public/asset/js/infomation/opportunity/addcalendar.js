$(function(){$('#beginDateTime, #endDateTime').each(function(){var option={format:'DD/MM/YYYY hh:mm A',minDate:moment(),startDate:moment(),endDate:moment(),showDropdowns:true,timePicker:true,timePickerIncrement:15,opens:'left',singleDatePicker:true};$(this).daterangepicker(option)});$('#tag-input').autocomplete({source:function(request,response){$.post('/system/user/suggest',{'q':request.term,},function(rs){if(rs.code){response(rs.data);}else{response([]);}});},minLength:2,select:function(event,ui){event.preventDefault()
addUser(ui.item)},close:function(){$('#tag-input').val('');}});$('#calendar_user_input').on('click','span[data-role="remove"]',function(){$(this).parent().remove();var userIds=[];$('#calendar_user_input span.tag').each(function(){userIds.push($(this).attr('idref'));});$('#calendar_userIds').val(userIds.join(','));});});function addUser(item){if(!$('#calendar_user_input').find('span[idref="'+item.id+'"]').length){var tag=$('<span/>').addClass('tag label label-info').attr('idref',item.id).text(item.username).append($('<span>').attr('data-role','remove'));$('#tag-input').before(tag);var userIds=[];$('#calendar_user_input span.tag').each(function(){userIds.push($(this).attr('idref'));});$('#calendar_userIds').val(userIds.join(','));}
$('#tag-input').autocomplete('close');$('#tag-input').val('');}