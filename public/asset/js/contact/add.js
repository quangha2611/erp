$(function(){$('#birthdate').daterangepicker({format:'DD/MM/YYYY',startDate:moment().subtract(18,'years'),endDate:moment().subtract(18,'years'),showDropdowns:true,opens:'left',singleDatePicker:true});$('.deleteContact').click(function(){var id=$(this).attr('data-id');var html="<div class='alert alert-info alert-dismissable'>Bạn có muốn xóa liên hệ này?</div>";$("#myModal").modal('show');$('#myModal .modal-body').empty();$('#myModal .modal-body').append(html);$('#myModal .modal-footer').append("<div class='deleteId' value='"+id+"'></div>");});$('#myModal .modal-footer').on('click','.accept',deleteConfirm);function deleteConfirm(){var id=$('.deleteId').attr('value');$.post("/crm/contact/delete",{id:id},function(rs){var html='<div class="alert alert-success alert-dismissable">'+rs.messages+'</div>';if(rs.code>0){$("#myModal").modal('hide');$("#alertModal").modal('show');$('#alertModal .modal-body').empty();$('#alertModal .modal-body').append(html);}else{var html='<div class="alert alert-warning alert-dismissable"> '+rs.messages+'</div>';$("#myModal").modal('hide');$("#alertModal").modal('show');$('#alertModal .modal-body').empty();$('#alertModal .modal-body').append(html);}});}
$('.modal-footer').on('click',function(){window.location.reload();});$('#customerName').catcomplete({source:function(request,response){$.post('/crm/customer/suggest',{'q':request.term,'page':'customer.catcomplete.account'},function(rs){if(rs.code){response(rs.data);}});},response:function(event,ui){if(typeof ui.content=='undefined'||ui.content.length===0){$(".empty-message").show();}else{$(".empty-message").hide();}},minLength:2,select:function(event,ui){$('#accountId').val(ui.item.id);if(typeof ui.item.name!="undefined"||typeof ui.item.companyName!="undefined"){var text=ui.item.companyName?ui.item.companyName:ui.item.name;$('#customer-Name').val(text);}else{$('#customer-Name').val('');}
if(typeof ui.item.mobile!='undefined'){var text=ui.item.mobile.join(' - ');$('#customerMobile').val(text);}else{$('#customerMobile').val('');}
if(typeof ui.item.email!='undefined'){var text=ui.item.email.join(' - ');$('#customerEmail').val(text);}else{$('#customerEmail').val('');}
if(typeof ui.item.address!='undefined'){var text=ui.item.address;$('#customerAddress').val(text);}else{$('#customerAddress').val('');}
if(typeof ui.item.website!='undefined'){var text=ui.item.website;$('#customerWebsite').val(text);}else{$('#customerWebsite').val('');}
$('.customerInfor').slideDown(300);},});});