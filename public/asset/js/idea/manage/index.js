$(function(){$('#exportExcel').jsExcelExport({'param':{'format':'excel'}});$('#exportAll').jsExcelExport({'param':{'format':'excelAll'}})
Department.load('#companyId','#departmentId');IdeaCategory.load('#companyId','#categoryId');var pageNewest=2;var pageMostlike=2;$('.idea-content').on('click','.like-idea',function(){var ideaId=$(this).attr('data-id');var number=$(this).attr('data-like');number=parseInt(number)+1;$.post('/idea/manage/like',{'ideaId':ideaId},function(rs){if(rs.code){var html='<i class="fa fa-thumbs-o-up mgr-5"></i>('+number+')';$('.show-like-'+ideaId).empty();$('.show-like-'+ideaId).append(html);}});});$('#createdByName').autocomplete({source:function(request,response){$.post('/system/user/suggest',{'q':request.term,'page':'task.index'},function(rs){if(rs.code){response(rs.data);}});},minLength:2,select:function(event,ui){$('#createdById').val(ui.item.id);}});$('#createdByName').on('change',function(){if(!$('#createdByName').val()){$('#createdById').val('');}});$('.delete_idea').on('click',function(){var item=$(this);$.post("/idea/manage/delete",{id:$(this).attr('data-id'),},function(rs){if(rs.code){item.closest('td').closest('tr').remove();}else{var html='<div class="alert alert-warning alert-dismissable"> '+rs.messages+'</div>';$("#myModal").modal('hide');$("#alertModal").modal('show');$('#alertModal .modal-body').empty();$('#alertModal .modal-body').append(html);}});});$('#ApproveByName').autocomplete({source:function(request,response){$.post('/system/user/suggest',{'q':request.term,'page':'task.index'},function(rs){if(rs.code){response(rs.data);}});},minLength:2,select:function(event,ui){$('#approvedById').val(ui.item.id);}});$('#ApproveByName').on('change',function(){if(!$('#ApproveByName').val()){$('#approvedById').val('');}});function _approveidea(a){$.post('/idea/manage/approved',{ideaId:a.id,approve:a.approve},function(r){if(r.code==0){$('#ApproveIdea .alert-warning').empty().html(r.messages);setTimeout(function(){$('#ApproveIdea').modal('hide');location.reload();},1000);}else if(r.code==1){$('#ApproveIdea .alert-warning').empty().html(r.messages);setTimeout(function(){$('#ApproveIdea').modal('hide');location.reload();},1500);}});}
$('.ApproveIdea').click(function(){$('#ApproveIdea').modal('show');$('#ideaId').val('').val($(this).attr('data-id'));});$('#ApproveIdea').find('.yes').click(function(){_approveidea({id:$('#ideaId').val(),approve:1});});$('#ApproveIdea').find('.no').click(function(){_approveidea({id:$('#ideaId').val(),approve:2});});$('.reApprove').on('click',function(){$('#confirmReApproveModal').modal('show');$('#ideaIdre').val($(this).attr('data-id'));});$('#confirmReApproveModal .btn-submit').on('click',function(){$(this).prop('disabled',true);$(this).button('loading');$.post('/idea/manage/reapprove',{'id':$('#ideaIdre').val(),},function(rs){$('#confirmReApproveModal .btn-submit').button('reset');$('#confirmReApproveModal .btn-submit').prop('disabled',false);if(typeof rs.code=='undefined'){$('#errorModal .alert').html(pageVariables.messages.SERVER_ERROR);$('#errorModal').modal('show');}else{if(rs.code){$('#confirmReApproveModal .btn-submit').prop('disabled',true);location.reload();}else{$('#errorModal .alert').html(rs.messages.join('</br>'));$('#errorModal').modal('show');}}});});});