$(function(){$('#exportExcel').jsExcelExport({'param':{'format':'excel'}});$('#exportAll').jsExcelExport({'param':{'format':'excelAll'}})
$('#createdByName').catcomplete({source:function(request,response){$.post('/hrm/employee/suggest',{'q':request.term,'page':'category.company'},function(rs){if(rs.code){response(rs.data);}});},minLength:2,select:function(event,ui){$('#createdById').val(ui.item.userId);},});$('#relatedUserName').catcomplete({source:function(request,response){$.post('/hrm/employee/suggest',{'q':request.term,'page':'category.company'},function(rs){if(rs.code){response(rs.data);}});},minLength:2,select:function(event,ui){$('#relatedUserId').val(ui.item.userId);},});$('#createdByName').on('change',function(){if(!$(this).val()){$('#createdById').val('');}})
$('#relatedUserName').on('change',function(){if(!$(this).val()){$('#relatedUserId').val('');}})
$('.deleteActivity').on('click',function(){var item=$(this);$.post('/crm/activity/deleteactivity',{'id':$(this).attr('data-id'),},function(rs){if(rs.code){item.closest('tr').remove();}else{html='<div class="alert alert-warning alert-dismissable">'+rs.messages+'</div>';$("#alertModal").modal('show');$('#alertModal .modal-body').empty();$('#alertModal .modal-body').append(html);}});});});